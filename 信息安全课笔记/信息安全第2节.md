# 完整性保护
## 完整性包括
### 内容完整性
* 就是保证传输的内容不被篡改
### 序列完整性
* 保证报文序列不被篡改
* 通常通过报文序号，坚守放检查序号来鉴别是否被篡改序列完整性
### 时间完整性
* 保证报文不被延迟or回放
* 保证措施
    * 时间戳机制
    * 询问-应答机制
## 消息认证-鉴别码（MAC）
### 核心是 内容认证
### 功能上分为2个层次
* 底层
    * 认证函数
        * 使报文产生唯一的鉴别码
* 上层
    * 认证协议
### 完整性保护的基本原理
* 利用认证函数生成给予报文的鉴别码A
* 将报文（是否保密取决于需求） + 鉴别码A发送给接收方
* 接收方利用收到的报文生成鉴别码B，如果AB相等，就安全
### MAC函数
* 它是一个与加密函数类似的函数，均需要通信双方密钥
* 加密算法要求可逆性，MAC算法不要求可逆性
* 在加密函数中，明文密文一般等长，为1对1的函数；而在mac中，消息可以任意长，生成的鉴别码长度固定（就是多对一）（或者理解为hash）
* MAC函数具有的性质
    * 没讲？还是我睡着了…
* CBC-MAC
    * 是ANSI标准，数据认证算法
* hash函数，将任意长的输入消息通过哈希算法变成固定长度的输出串（比如md5）（称为数据指纹）
    * 给定M，计算h=H(M)很容易; 给定h,找到一个M,使得h=H(M)在计算上是不可能的，即单向性
        * 这个也是课上没有明白的原因，注意使得计算找到一个M,使得h=H(M）这个过程异常困难才是安全性的保证
    * 对于给定的M及其哈希值h, 要找到另外一个M*!=M, 使得H(M*)=H(M)在计算上是不可能的，即弱抗碰撞(collision)性 (防止替代性报文，伪造)
    * hash函数不适用密钥，但是我们穿入的参数是带密钥的
*XMind: ZEN - Trial Version*